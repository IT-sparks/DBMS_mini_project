create database IPL_TOURNAMENT;



CREATE TABLE TEAM
( 	TEAM_NAME VARCHAR(50) PRIMARY KEY,
	STATE  VARCHAR(50) NOT NULL,
	HEAD_COACH VARCHAR(50) UNIQUE NOT NULL,
	NO_OF_TITLES INTEGER NOT NULL,
	CAPTAIN  CHAR(10)  UNIQUE NOT NULL,
	POOL CHAR(1)NOT NULL,
	CHECK (NO_OF_TITLES >= 0 AND NO_OF_TITLES < 13),
	CHECK ( POOL IN ('A','B'))
);

ALTER TABLE TEAM
ADD CONSTRAINT "CAPTAIN_ID_FKEY" FOREIGN KEY (CAPTAIN) REFERENCES PLAYER(FRANCHISE_PLAYER_ID);

CREATE TABLE PLAYER
(
	FRANCHISE_PLAYER_ID CHAR(10) PRIMARY KEY,
	SKILL INTEGER ,
	POSITION VARCHAR(15) NOT NULL,
	NAME VARCHAR(50) NOT NULL,
	TEAM VARCHAR(50) ,
	CHECK (SKILL > 0 AND SKILL < 11),
	CHECK (POSITION IN ('BOWLER','BATSMAN','ALL-ROUNDER','WICKET-KEEPER'))
);

ALTER TABLE PLAYER
ADD CONSTRAINT "TEAM_NAME_FKEY"FOREIGN KEY (TEAM) REFERENCES TEAM(TEAM_NAME) ON DELETE CASCADE;


CREATE TABLE INJURY_RECORD
(
	PLAYER_ID CHAR(10),
	DESCRIPTION VARCHAR(50) NOT NULL,
	DATE_OF_INJURY DATE NOT NULL,
	DETAILS TEXT,
	PRIMARY KEY(PLAYER_ID,DESCRIPTION)
);

ALTER TABLE INJURY_RECORD 
ADD CONSTRAINT "INJURED_player_id" FOREIGN KEY (PLAYER_ID) REFERENCES PLAYER(FRANCHISE_PLAYER_ID);


CREATE TABLE SPONSOR
(
	CORPORATE_NAME VARCHAR(50) PRIMARY KEY,
	FUNDS INTEGER NOT NULL,
	TEAM VARCHAR(50) ,
	TIME_PERIOD_YEARS INTEGER NOT NULL
);

ALTER TABLE SPONSOR 
ADD CONSTRAINT 'SPONSORING_TEAM' FOREIGN KEY (TEAM) REFERENCES TEAM(TEAM_NAME);


CREATE TABLE GAME
(
	HOST VARCHAR(50) REFERENCES TEAM(TEAM_NAME),
	VISITOR VARCHAR(50) REFERENCES TEAM(TEAM_NAME),
	VENUE VARCHAR(50) NOT NULL,
	DATE_OF_GAME DATE NOT NULL,
	PRIMARY KEY(HOST,VISITOR)
);
